var i;const header=document.querySelector(".header"),body=document.querySelector("body"),hamburgerMenu=document.querySelector(".hamburger-menu"),hoverClose=(header.addEventListener("click",function(e){var t=e.target.closest(".hamburger-menu");hamburgerMenu.classList.contains("hamburger-menu--unToggled")?(hamburgerMenu.classList.remove("hamburger-menu--unToggled"),hamburgerMenu.classList.add("hamburger-menu--toggled")):(hamburgerMenu.classList.contains("hamburger-menu--toggled")&&e.target.closest(".nav__item")||e.target.closest(".hamburger-menu"))&&(hamburgerMenu.classList.add("hamburger-menu--unToggled"),hamburgerMenu.classList.remove("hamburger-menu--toggled")),t&&e.target.closest(".header--fullscreen")?(header.classList.remove("header--fullscreen"),body.style.overflow="inherit"):t&&e.target.closest(".hamburger-menu")&&(header.classList.add("header--fullscreen"),body.style.overflow="hidden")}),document.querySelector(".composition__close-btn")),hoverOpen=document.querySelector(".burger-card__composition--item"),reviewButton=(hoverClose.addEventListener("click",function(e){e.preventDefault(),document.querySelector(".burger-card__composition--hover").style.display="none"}),screen.width<769&&hoverOpen.addEventListener("click",function(e){e.preventDefault(),document.querySelector(".burger-card__composition--hover").style.display="block"}),document.querySelectorAll(".reviews__btn")),template=document.querySelector("#reviewsPopup").innerHTML;for(i=0;i<reviewButton.length;i++)reviewButton[i].addEventListener("click",function(e){e=createOverlay(e.path[2].querySelector(".reviews__title").innerHTML,e.path[2].querySelector(".reviews__text").innerHTML);document.querySelector(".reviews").append(e)});function createOverlay(e,t){const r=document.createElement("div"),n=(r.classList.add("overlay"),r.innerHTML=template,r.querySelector(".overlay__close-btn"));return r.addEventListener("click",function(e){e.target===r&&n.click()}),n.addEventListener("click",function(e){e.preventDefault(),document.querySelector(".reviews").removeChild(r)}),r.querySelector(".reviews__overlay--title").innerHTML=e,r.querySelector(".reviews__overlay--text").innerHTML=t,r}const itemVertAccordeon=document.querySelectorAll(".vertical-accordeon__item");for(i=0;i<itemVertAccordeon.length;i++)itemVertAccordeon[i].addEventListener("click",function(e){if(e.preventDefault(),e.target.closest(".vertical-accordeon__item").classList.contains("vertical-accordeon__item--active"))e.target.closest(".vertical-accordeon__item").classList.remove("vertical-accordeon__item--active");else{for(let e=0;e<itemVertAccordeon.length;e++)itemVertAccordeon[e].classList.remove("vertical-accordeon__item--active");e.target.closest(".vertical-accordeon__item").classList.add("vertical-accordeon__item--active")}});const itemTeamAccordeon=document.querySelectorAll(".staff__item");for(i=0;i<itemTeamAccordeon.length;i++)itemTeamAccordeon[i].addEventListener("click",function(e){if(e.target.closest(".staff__item").classList.contains("staff__active"))e.target.closest(".staff__item").classList.remove("staff__active");else{for(let e=0;e<itemTeamAccordeon.length;e++)itemTeamAccordeon[e].classList.remove("staff__active");e.target.closest(".staff__item").classList.add("staff__active")}});const templateForm=document.querySelector("#formPopup").innerHTML,sendButton=document.querySelector("#sendBtn"),sendForm=document.querySelector(".form__elem");let dataForm,textFormPopup,textFormPopupError="Вы не ввели... ";function createFormOverlay(e){const t=document.createElement("div"),r=(t.classList.add("overlay"),t.innerHTML=templateForm,t.querySelector(".btn--overlay"));t.addEventListener("click",function(e){e.target===t&&r.click()}),r.addEventListener("click",function(e){e.preventDefault(),document.querySelector(".order").removeChild(t)}),t.querySelector(".reviews__overlay--text").innerHTML=e,document.querySelector(".order").append(t)}function validateForm(e){let t=!0;return validateField(e.elements.comment)||(t=!1,textFormPopup=textFormPopupError+"Комментарий!"),validateField(e.elements.phone)||(t=!1,textFormPopup=textFormPopupError+"Телефон!"),validateField(e.elements.name)||(t=!1,textFormPopup=textFormPopupError+"Имя!"),t}function validateField(e){return e.checkValidity()}function createData(){let e=new FormData(sendForm);return e.append("name",sendForm.elements.name.value),e.append("phone",sendForm.elements.phone.value),e.append("comment",sendForm.elements.comment.value),e.append("to","vasy@liy.com"),e}sendButton.addEventListener("click",e=>{if(e.preventDefault(),validateForm(sendForm)){e=createData();const t=new XMLHttpRequest;t.open("POST","https://webdev-api.loftschool.com/sendmail"),t.responseType="json",t.send(e),t.addEventListener("load",function(){t.response.status,createFormOverlay(textFormPopup=t.response.message)}),textFormPopup=""}else createFormOverlay(textFormPopup),textFormPopup=""}),function(){ymaps.ready(function(){for(var e=new ymaps.Map("map",{center:[59.94,30.32],zoom:12,controls:["zoomControl"],behaviors:["drag"]}),t=0;t<n.length;t++)o[t]=new ymaps.Placemark([n[t].latitude,n[t].longitude],{hintContent:n[t].hintContent},{iconLayout:"default#image",iconImageHref:"./img/icons/map-marker.svg",iconImageSize:[46,57],iconImageOffset:[-23,-57]});var r=new ymaps.Clusterer({clusterIcons:[{href:"./img/content/1st_screen_hero/main_burger.png",size:[100,100],offset:[-50,-50]}],clusterIconContentLayout:null});e.geoObjects.add(r),r.add(o)});var n=[{latitude:59.97,longitude:30.31,hintContent:'<div class="map__hint">ул. Литераторов, д. 19</div>'},{latitude:59.94,longitude:30.25,hintContent:'<div class="map__hint">Малый проспект В О, д 64</div>'},{latitude:59.93,longitude:30.34,hintContent:'<div class="map__hint">наб. реки Фонтанки, д. 56</div>'}],o=[]}(),function(){const a=document.querySelectorAll(".section"),s=document.querySelectorAll(".fixed-menu__item"),l=document.querySelector(".maincontent");let c=!1,t=document.querySelectorAll("[data-scroll-to]");const o=t=>{if(0==c){c=!0;var r,n,o=-100*t+"%";setTimeout(u,500),setTimeout(m,500),a[t].classList.add("section--active"),s[t].classList.add("fixed-menu__item--active");let e=i(a[t]);for(r in e)e[r].classList.contains("section--active")&&e[r].classList.remove("section--active");for(n in e=i(s[t]))e[n].classList.contains("fixed-menu__item--active")&&e[n].classList.remove("fixed-menu__item--active");l.style.cssText=`transform: translateY(${o});`,setTimeout(()=>{c=!1},500)}},r=e=>{let t=0;for(let e=0;e<a.length;e++)a[e].classList.contains("section--active")&&(t=e);var r=t-1,n=t+1;"prev"===e&&0<=r&&o(r),"next"===e&&n<a.length&&o(n)};function i(e){let t=[],r=e;for(;r.previousSibling;)1==(r=r.previousSibling).nodeType&&t.push(r);for(r=e;r.nextSibling;)1==(r=r.nextSibling).nodeType&&t.push(r);return t}document.addEventListener("wheel",e=>{e=e.deltaY;0<e&&r("next"),e<0&&r("prev")}),document.addEventListener("keydown",e=>{switch(e.keyCode){case 38:r("prev");break;case 40:r("next")}});for(let e=0;e<t.length;e++)t[e].addEventListener("click",e=>{e.preventDefault();e=parseInt(e.target.dataset.scrollTo);o(e)});window.addEventListener("touchmove",e=>{e.preventDefault()},{passive:!1});let n,d;function u(){hamburgerMenu.classList.contains("hamburger-menu--unToggled")&&header.classList.contains("header--fullscreen")?(hamburgerMenu.classList.remove("hamburger-menu--unToggled"),hamburgerMenu.classList.add("hamburger-menu--toggled")):(hamburgerMenu.classList.add("hamburger-menu--unToggled"),hamburgerMenu.classList.remove("hamburger-menu--toggled")),header.classList.remove("header--fullscreen"),body.style.overflow="inherit"}function m(){document.querySelector(".overlay")&&document.querySelector(".overlay").remove()}document.addEventListener("touchstart",e=>{n=e}),document.addEventListener("touchmove",e=>{n&&(0<(d=e.touches[0].pageY-n.touches[0].pageY)&&r("prev"),d<0&&r("next"))}),document.addEventListener("touched",function(e){n=null})}(),function(){document.querySelector(".slider-container__list");let r=document.querySelector(".slider-container__items"),t=document.querySelectorAll(".slider-container__item");var e=document.querySelector(".slider-container__list").clientWidth;let n=document.querySelector("#slider-left"),o=document.querySelector("#slider-right"),a=document.querySelector(".slider-dots"),s=document.querySelectorAll(".burger-card__pic"),l;const c=e*t.length,d=e;let u=0,m;for(i=0;i<t.length;i++)t[i].style.minWidth=e+"px";n.addEventListener("click",e=>{e.preventDefault(),0<Math.abs(u)?(u+=d,r.style.transform=`translateX(${u}px)`):(r.style.transform=`translateX(-${c-d}px)`,u=-(c-d)),v(m=-(u/d))}),o.addEventListener("click",e=>{e.preventDefault(),Math.abs(u)<c-d?(u-=d,r.style.transform=`translateX(${u}px)`):(r.style.transform="translateX(0px)",u=0),v(m=-(u/d))});for(let e=0;e<t.length;e++)a.append(function(e){let t=document.createElement("li"),r=(t.classList.add("slider-dots__img"),document.createElement("img")),n=(r.classList.add("slider-dots__img--pic"),s[e].getAttribute("src")),o=s[e].getAttribute("alt");return r.setAttribute("src",n),r.setAttribute("alt",o),t.append(r),t}(e));0<(l=document.querySelectorAll(".slider-dots__img")).length&&l[0].classList.add("slider-dots__img--active");for(let t=0;t<l.length;t++)l[t].addEventListener("click",()=>{var e;v(t),e=t,u=d*-e,r.style.transform=`translateX(${u}px)`});function v(e){l[e].classList.add("slider-dots__img--active");let t=function(e){let t=[],r=e;for(;r.previousSibling;)1==(r=r.previousSibling).nodeType&&t.push(r);r=e;for(;r.nextSibling;)1==(r=r.nextSibling).nodeType&&t.push(r);return t}(l[e]);for(var r in t)t[r].classList.contains("slider-dots__img--active")&&t[r].classList.remove("slider-dots__img--active")}}(),function(){document.createElement("script");let e=document.querySelector(".videocontent__play-btn"),t=document.querySelector(".videocontent__pause-btn"),r=document.querySelector(".controls__play"),n=document.querySelector(".controls__pause"),o=document.querySelector(".videocontent__controls"),a=document.querySelector(".controls__volume-level"),s=document.querySelector(".controls__volume"),l=document.querySelector(".controls__timeline-current"),c=document.querySelector(".controls__timeline-total"),i=document.querySelector(".controls__speed-btn"),d=document.querySelector(".controls__timeline"),u;onYouTubeIframeAPIReady=()=>{u=new YT.Player("videocontent__iframe",{videoId:"Wdc8IuU7foE",events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange},playerVars:{controls:0,disablekb:0,showinfo:0,rel:0,autoplay:0,modestbranding:0,playsinline:1,fs:0}})},onPlayerReady=()=>{playPauseVideoOnPlayerReady(),setTotalTime(),setTimelineParams()},onPlayerStateChange=()=>{playPauseVideoOnPlayerStateChange(),setVolume(),muteVolume(),setInterval(setCurrentTime,500),changeSpeed(),changeTime()},playPauseVideoOnPlayerReady=()=>{e.addEventListener("click",togglePlay),r.addEventListener("click",togglePlay)},playPauseVideoOnPlayerStateChange=()=>{2==u.getPlayerState()&&togglePause(),0==u.getPlayerState()&&toggleStop(),t.addEventListener("click",()=>{togglePause()}),n.addEventListener("click",()=>{togglePause()})},togglePlay=()=>{e.classList.add("videocontent__play-btn--active"),t.classList.add("videocontent__pause-btn--active"),n.classList.add("controls__pause--active"),r.classList.remove("controls__play--active"),o.classList.remove("videocontent__controls--paused"),u.playVideo()},togglePause=()=>{e.classList.remove("videocontent__play-btn--active"),t.classList.remove("videocontent__pause-btn--active"),n.classList.remove("controls__pause--active"),r.classList.add("controls__play--active"),o.classList.add("videocontent__controls--paused"),u.pauseVideo()},toggleStop=()=>{e.classList.remove("videocontent__play-btn--active"),t.classList.remove("videocontent__pause-btn--active"),n.classList.remove("controls__pause--active"),r.classList.add("controls__play--active"),u.stopVideo()},muteVolume=()=>{s.addEventListener("click",()=>{u.isMuted()?(u.unMute(),s.classList.remove("controls__volume--muted"),u.setVolume(50),a.value=50):(u.mute(),s.classList.add("controls__volume--muted"))})},setVolume=()=>{u.setVolume(a.value),a.addEventListener("input",e=>{u.setVolume(e.target.value),0==e.target.value?(s.classList.add("controls__volume--muted"),u.mute()):(s.classList.remove("controls__volume--muted"),u.unMute())})},setTotalTime=()=>{c.innerHTML=formatDurtion(u.getDuration())},setCurrentTime=()=>{l.innerHTML=formatDurtion(u.getCurrentTime()),d.value=u.getCurrentTime()},formatDurtion=e=>{var t=Math.floor(e%60),e=Math.floor(e/60)%60;return 0==e&&t<10?"0:0"+t:0==e?"0:"+t:e+":"+t},changeSpeed=()=>{i.addEventListener("click",changeSpeedValue)},changeSpeedValue=()=>{1==u.getPlaybackRate()?(u.setPlaybackRate(2),i.innerHTML="2x"):(u.setPlaybackRate(1),i.innerHTML="1x")},setTimelineParams=()=>{d.setAttribute("min",0),d.setAttribute("max",u.getDuration())},changeTime=()=>{d.addEventListener("input",e=>{u.seekTo(e.target.value),togglePlay()})}}();